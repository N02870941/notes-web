language: node_js

node_js:
  - '10.1'

sudo: required

cache:
  npm: true
  directories:
  - node_modules
  - functions/node_modules

before_script:
  - npm install firebase-tools -g
  - cd functions && npm install && cd ..
  - npm install

script:
  - npm test
  - npm run build
  - firebase deploy --token "${FIREBASE_TOKEN}"
